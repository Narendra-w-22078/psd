

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Analisis Voice (Audio) menggunakan TSFEL &#8212; PSD</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Identifikasi_Suara';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Prediksi NO2" href="Prediksi_NO2.html" />
    <link rel="prev" title="Voice Cloning &amp; Augmentation untuk Training Dataset" href="Cloning_Suara.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/foto-naren.jpg" class="logo__image only-light" alt="PSD - Home"/>
    <script>document.write(`<img src="_static/foto-naren.jpg" class="logo__image only-dark" alt="PSD - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pengantar.html">Pengantar Proyek Sains Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Business_Understanding.html">Business Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_Understanding.html">Data Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Explorasi_Data.html">Explorasi Data Iris</a></li>


<li class="toctree-l1"><a class="reference internal" href="Data_Preprocessing.html">Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="SMOTE_ADASYN.html">Tugas Penyeimbangan data dengan SMOTE dan ADASYN</a></li>


<li class="toctree-l1"><a class="reference internal" href="classifier.html">KLASIFIKASI NAIVE BAYES, RF, BAGGING</a></li>
<li class="toctree-l1"><a class="reference internal" href="KNIME.html">KNIME</a></li>


<li class="toctree-l1"><a class="reference internal" href="Time_Series_Forecasting.html">Time Series Forecasting</a></li>

<li class="toctree-l1"><a class="reference internal" href="Cloning_Suara.html">Voice Cloning &amp; Augmentation untuk Training Dataset</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analisis Voice (Audio) menggunakan TSFEL</a></li>
<li class="toctree-l1"><a class="reference internal" href="Prediksi_NO2.html">Prediksi NO2</a></li>
<li class="toctree-l1"><a class="reference internal" href="UAS.html">Klasifikasi Kejadian Gempa Besar Menggunakan Fitur Ekstraksi Dari 512 Jam Data Seismik (Time Series Classification)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FIdentifikasi_Suara.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Identifikasi_Suara.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analisis Voice (Audio) menggunakan TSFEL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#persiapan-lingkungan-install-import">0) Persiapan lingkungan (install &amp; import)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muat-semua-file-audio-dari-folder-buka-dan-tutup">1) Muat semua file audio dari folder buka dan tutup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-durasi-audio-dan-statistik-dasar">2) Analisis durasi audio dan statistik dasar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konfigurasi-fitur-tsfel">3) Konfigurasi fitur TSFEL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur-tsfel-untuk-semua-audio">4) Ekstraksi fitur TSFEL untuk semua audio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bersihkan-fitur-nan-inf-simpan-ke-csv">5) Bersihkan fitur (NaN/Inf), simpan ke CSV</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standarisasi-visualisasi-pca-2d">6) Standarisasi &amp; visualisasi (PCA 2D)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-dengan-berbagai-algoritma">7) Klasifikasi dengan berbagai algoritma</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-feature-importance">8) Analisis Feature Importance</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-voice-audio-menggunakan-tsfel">
<h1>Analisis Voice (Audio) menggunakan TSFEL<a class="headerlink" href="#analisis-voice-audio-menggunakan-tsfel" title="Permalink to this heading">#</a></h1>
<p><strong>Feature extraction audio (voice)</strong> dengan [TSFEL] untuk klasifikasi suara “buka” dan “tutup”</p>
<section id="persiapan-lingkungan-install-import">
<h2>0) Persiapan lingkungan (install &amp; import)<a class="headerlink" href="#persiapan-lingkungan-install-import" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>streamlit<span class="w"> </span>streamlit-webrtc<span class="w"> </span>audio-recorder-streamlit<span class="w"> </span>tsfel<span class="w"> </span>librosa<span class="w"> </span>soundfile<span class="w"> </span>numpy<span class="w"> </span>pandas<span class="w"> </span>matplotlib<span class="w"> </span>scikit-learn<span class="w"> </span>scipy<span class="w"> </span>pydub<span class="w"> </span>av<span class="w"> </span>joblib<span class="w"> </span>tqdm
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: streamlit in /home/codespace/.python/current/lib/python3.12/site-packages (1.49.1)
Requirement already satisfied: streamlit-webrtc in /home/codespace/.python/current/lib/python3.12/site-packages (0.63.11)
Requirement already satisfied: audio-recorder-streamlit in /home/codespace/.python/current/lib/python3.12/site-packages (0.0.10)
Requirement already satisfied: tsfel in /home/codespace/.python/current/lib/python3.12/site-packages (0.2.0)
Requirement already satisfied: librosa in /home/codespace/.python/current/lib/python3.12/site-packages (0.11.0)
Requirement already satisfied: soundfile in /home/codespace/.python/current/lib/python3.12/site-packages (0.13.1)
Requirement already satisfied: numpy in /home/codespace/.local/lib/python3.12/site-packages (2.3.1)
Requirement already satisfied: pandas in /home/codespace/.local/lib/python3.12/site-packages (2.3.1)
Requirement already satisfied: matplotlib in /home/codespace/.local/lib/python3.12/site-packages (3.10.3)
Requirement already satisfied: scikit-learn in /home/codespace/.local/lib/python3.12/site-packages (1.7.0)
Requirement already satisfied: scipy in /home/codespace/.local/lib/python3.12/site-packages (1.16.0)
Requirement already satisfied: pydub in /home/codespace/.python/current/lib/python3.12/site-packages (0.25.1)
Requirement already satisfied: av in /home/codespace/.python/current/lib/python3.12/site-packages (16.0.1)
Requirement already satisfied: joblib in /home/codespace/.local/lib/python3.12/site-packages (1.5.1)
Requirement already satisfied: tqdm in /home/codespace/.python/current/lib/python3.12/site-packages (4.67.1)
Requirement already satisfied: altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (4.2.2)
Requirement already satisfied: blinker&lt;2,&gt;=1.5.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (1.9.0)
Requirement already satisfied: cachetools&lt;7,&gt;=4.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (6.2.0)
Requirement already satisfied: click&lt;9,&gt;=7.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (8.2.1)
Requirement already satisfied: packaging&lt;26,&gt;=20 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (25.0)
Requirement already satisfied: pillow&lt;12,&gt;=7.1.0 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (11.3.0)
Requirement already satisfied: protobuf&lt;7,&gt;=3.20 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (6.32.1)
Requirement already satisfied: pyarrow&gt;=7.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (21.0.0)
Requirement already satisfied: requests&lt;3,&gt;=2.27 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (2.32.4)
Requirement already satisfied: tenacity&lt;10,&gt;=8.1.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (9.1.2)
Requirement already satisfied: toml&lt;2,&gt;=0.10.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (0.10.2)
Requirement already satisfied: typing-extensions&lt;5,&gt;=4.4.0 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (4.14.1)
Requirement already satisfied: watchdog&lt;7,&gt;=2.1.5 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (6.0.0)
Requirement already satisfied: gitpython!=3.1.19,&lt;4,&gt;=3.0.7 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (3.1.44)
Requirement already satisfied: pydeck&lt;1,&gt;=0.8.0b4 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit) (0.9.1)
Requirement already satisfied: tornado!=6.5.0,&lt;7,&gt;=6.0.3 in /home/codespace/.local/lib/python3.12/site-packages (from streamlit) (6.5.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: entrypoints in /home/codespace/.python/current/lib/python3.12/site-packages (from altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (0.4)
Requirement already satisfied: jinja2 in /home/codespace/.local/lib/python3.12/site-packages (from altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (3.1.6)
Requirement already satisfied: jsonschema&gt;=3.0 in /home/codespace/.local/lib/python3.12/site-packages (from altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (4.24.0)
Requirement already satisfied: toolz in /home/codespace/.python/current/lib/python3.12/site-packages (from altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (1.1.0)
Requirement already satisfied: gitdb&lt;5,&gt;=4.0.1 in /home/codespace/.local/lib/python3.12/site-packages (from gitpython!=3.1.19,&lt;4,&gt;=3.0.7-&gt;streamlit) (4.0.12)
Requirement already satisfied: smmap&lt;6,&gt;=3.0.1 in /home/codespace/.local/lib/python3.12/site-packages (from gitdb&lt;5,&gt;=4.0.1-&gt;gitpython!=3.1.19,&lt;4,&gt;=3.0.7-&gt;streamlit) (5.0.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (3.4.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/codespace/.local/lib/python3.12/site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (2025.7.9)
Requirement already satisfied: aioice&gt;=0.10.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit-webrtc) (0.10.1)
Requirement already satisfied: aiortc&gt;=1.11.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from streamlit-webrtc) (1.14.0)
Requirement already satisfied: ipython&gt;=7.4.0 in /home/codespace/.local/lib/python3.12/site-packages (from tsfel) (9.4.0)
Requirement already satisfied: PyWavelets&gt;=1.4.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from tsfel) (1.9.0)
Requirement already satisfied: setuptools&gt;=47.1.1 in /home/codespace/.local/lib/python3.12/site-packages (from tsfel) (80.9.0)
Requirement already satisfied: statsmodels&gt;=0.12.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from tsfel) (0.14.5)
Requirement already satisfied: audioread&gt;=2.1.9 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (3.1.0)
Requirement already satisfied: numba&gt;=0.51.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (0.62.0)
Requirement already satisfied: decorator&gt;=4.3.0 in /home/codespace/.local/lib/python3.12/site-packages (from librosa) (5.2.1)
Requirement already satisfied: pooch&gt;=1.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (1.8.2)
Requirement already satisfied: soxr&gt;=0.3.2 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (0.5.0.post1)
Requirement already satisfied: lazy_loader&gt;=0.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (0.4)
Requirement already satisfied: msgpack&gt;=1.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from librosa) (1.1.2)
Requirement already satisfied: cffi&gt;=1.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from soundfile) (2.0.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /home/codespace/.local/lib/python3.12/site-packages (from matplotlib) (1.3.2)
Requirement already satisfied: cycler&gt;=0.10 in /home/codespace/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /home/codespace/.local/lib/python3.12/site-packages (from matplotlib) (4.58.5)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /home/codespace/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /home/codespace/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /home/codespace/.local/lib/python3.12/site-packages (from scikit-learn) (3.6.0)
Requirement already satisfied: dnspython&gt;=2.0.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aioice&gt;=0.10.1-&gt;streamlit-webrtc) (2.8.0)
Requirement already satisfied: ifaddr&gt;=0.2.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aioice&gt;=0.10.1-&gt;streamlit-webrtc) (0.2.0)
Requirement already satisfied: cryptography&gt;=44.0.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aiortc&gt;=1.11.0-&gt;streamlit-webrtc) (46.0.3)
Requirement already satisfied: google-crc32c&gt;=1.1 in /home/codespace/.python/current/lib/python3.12/site-packages (from aiortc&gt;=1.11.0-&gt;streamlit-webrtc) (1.7.1)
Requirement already satisfied: pyee&gt;=13.0.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aiortc&gt;=1.11.0-&gt;streamlit-webrtc) (13.0.0)
Requirement already satisfied: pylibsrtp&gt;=0.10.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aiortc&gt;=1.11.0-&gt;streamlit-webrtc) (1.0.0)
Requirement already satisfied: pyopenssl&gt;=25.0.0 in /home/codespace/.python/current/lib/python3.12/site-packages (from aiortc&gt;=1.11.0-&gt;streamlit-webrtc) (25.3.0)
Requirement already satisfied: pycparser in /home/codespace/.local/lib/python3.12/site-packages (from cffi&gt;=1.0-&gt;soundfile) (2.22)
Requirement already satisfied: ipython-pygments-lexers in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (1.1.1)
Requirement already satisfied: jedi&gt;=0.16 in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.19.2)
Requirement already satisfied: matplotlib-inline in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.1.7)
Requirement already satisfied: pexpect&gt;4.3 in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (4.9.0)
Requirement already satisfied: prompt_toolkit&lt;3.1.0,&gt;=3.0.41 in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (3.0.51)
Requirement already satisfied: pygments&gt;=2.4.0 in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (2.19.2)
Requirement already satisfied: stack_data in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (0.6.3)
Requirement already satisfied: traitlets&gt;=5.13.0 in /home/codespace/.local/lib/python3.12/site-packages (from ipython&gt;=7.4.0-&gt;tsfel) (5.14.3)
Requirement already satisfied: wcwidth in /home/codespace/.local/lib/python3.12/site-packages (from prompt_toolkit&lt;3.1.0,&gt;=3.0.41-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.2.13)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.4 in /home/codespace/.local/lib/python3.12/site-packages (from jedi&gt;=0.16-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.8.4)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /home/codespace/.local/lib/python3.12/site-packages (from jinja2-&gt;altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (3.0.2)
Requirement already satisfied: attrs&gt;=22.2.0 in /home/codespace/.local/lib/python3.12/site-packages (from jsonschema&gt;=3.0-&gt;altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (25.3.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /home/codespace/.local/lib/python3.12/site-packages (from jsonschema&gt;=3.0-&gt;altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (2025.4.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /home/codespace/.local/lib/python3.12/site-packages (from jsonschema&gt;=3.0-&gt;altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (0.36.2)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /home/codespace/.local/lib/python3.12/site-packages (from jsonschema&gt;=3.0-&gt;altair!=5.4.0,!=5.4.1,&lt;6,&gt;=4.0-&gt;streamlit) (0.26.0)
Requirement already satisfied: llvmlite&lt;0.46,&gt;=0.45.0dev0 in /home/codespace/.python/current/lib/python3.12/site-packages (from numba&gt;=0.51.0-&gt;librosa) (0.45.0)
Requirement already satisfied: ptyprocess&gt;=0.5 in /home/codespace/.local/lib/python3.12/site-packages (from pexpect&gt;4.3-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.7.0)
Requirement already satisfied: platformdirs&gt;=2.5.0 in /home/codespace/.local/lib/python3.12/site-packages (from pooch&gt;=1.1-&gt;librosa) (4.3.8)
Requirement already satisfied: six&gt;=1.5 in /home/codespace/.local/lib/python3.12/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
Requirement already satisfied: patsy&gt;=0.5.6 in /home/codespace/.python/current/lib/python3.12/site-packages (from statsmodels&gt;=0.12.0-&gt;tsfel) (1.0.2)
Requirement already satisfied: executing&gt;=1.2.0 in /home/codespace/.local/lib/python3.12/site-packages (from stack_data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (2.2.0)
Requirement already satisfied: asttokens&gt;=2.1.0 in /home/codespace/.local/lib/python3.12/site-packages (from stack_data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (3.0.0)
Requirement already satisfied: pure-eval in /home/codespace/.local/lib/python3.12/site-packages (from stack_data-&gt;ipython&gt;=7.4.0-&gt;tsfel) (0.2.3)

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">25.2</span> -&gt; <span class=" -Color -Color-Green">25.3</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Audio utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">soundfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sf</span>  <span class="c1"># baca/tulis wav</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>          <span class="c1"># pemrosesan audio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>

<span class="c1"># TSFEL</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tsfel</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="muat-semua-file-audio-dari-folder-buka-dan-tutup">
<h2>1) Muat semua file audio dari folder buka dan tutup<a class="headerlink" href="#muat-semua-file-audio-dari-folder-buka-dan-tutup" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># === PATH KE DATASET ===</span>
<span class="n">BASE_PATH</span> <span class="o">=</span> <span class="s2">&quot;/workspaces/PSD/PSD/Data/voice_augmented&quot;</span>
<span class="n">BUKA_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_PATH</span><span class="p">,</span> <span class="s2">&quot;buka&quot;</span><span class="p">)</span>
<span class="n">TUTUP_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_PATH</span><span class="p">,</span> <span class="s2">&quot;tutup&quot;</span><span class="p">)</span>

<span class="c1"># Parameter sampling</span>
<span class="n">TARGET_SR</span> <span class="o">=</span> <span class="mi">16000</span>  <span class="c1"># 16 kHz umum untuk analisis speech</span>

<span class="c1"># === Fungsi untuk memuat dan preprocess audio ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_audio_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="mi">16000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Memuat file audio, trim silence, dan normalisasi&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">sample_rate</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Trim silence di awal/akhir</span>
        <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">effects</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">top_db</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="c1"># Normalisasi amplitudo</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y_trimmed</span> <span class="o">=</span> <span class="n">y_trimmed</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">sample_rate</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Gagal memuat </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># === Kumpulkan semua file audio ===</span>
<span class="n">audio_data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">filenames</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="c1"># Load file dari folder &#39;buka&#39;</span>
<span class="n">buka_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">BUKA_PATH</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.wav&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">buka_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> file dari folder &#39;buka&#39;...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">buka_files</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BUKA_PATH</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">load_audio_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">TARGET_SR</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">audio_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Label 0 untuk &quot;buka&quot;</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="c1"># Load file dari folder &#39;tutup&#39;</span>
<span class="n">tutup_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">TUTUP_PATH</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.wav&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tutup_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> file dari folder &#39;tutup&#39;...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">tutup_files</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TUTUP_PATH</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">load_audio_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">TARGET_SR</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">audio_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Label 1 untuk &quot;tutup&quot;</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total audio loaded: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Buka: </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">, Tutup: </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampling rate: </span><span class="si">{</span><span class="n">TARGET_SR</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

<span class="c1"># === Visualisasi beberapa contoh waveform ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Contoh Waveform dari Dataset&#39;</span><span class="p">)</span>

<span class="c1"># Plot 2 contoh dari &quot;buka&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">):</span>
        <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">waveshow</span><span class="p">(</span><span class="n">audio_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sr</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Buka - </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Waktu (detik)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitudo&#39;</span><span class="p">)</span>

<span class="c1"># Plot 2 contoh dari &quot;tutup&quot;</span>
<span class="n">buka_count</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">buka_count</span> <span class="o">+</span> <span class="n">i</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">):</span>
        <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">waveshow</span><span class="p">(</span><span class="n">audio_data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">sr</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tutup - </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Waktu (detik)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitudo&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading 100 file dari folder &#39;buka&#39;...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading 100 file dari folder &#39;tutup&#39;...

Total audio loaded: 200
Buka: 100, Tutup: 100
Sampling rate: 16000 Hz
</pre></div>
</div>
<img alt="_images/d04e20ca282013ff26914b03a9ce610ace7709e55cb8a8daf1bf7d1d9eaf81ea.png" src="_images/d04e20ca282013ff26914b03a9ce610ace7709e55cb8a8daf1bf7d1d9eaf81ea.png" />
</div>
</div>
</section>
<section id="analisis-durasi-audio-dan-statistik-dasar">
<h2>2) Analisis durasi audio dan statistik dasar<a class="headerlink" href="#analisis-durasi-audio-dan-statistik-dasar" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================================</span>
<span class="c1"># ANALISIS DURASI AUDIO &amp; VISUALISASI SPEKTRUM</span>
<span class="c1"># ==========================================================</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Analisis durasi audio</span>
<span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">TARGET_SR</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">audio_data</span><span class="p">]</span>
<span class="n">durations_buka</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">durations</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">durations_tutup</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">durations</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Statistik durasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Statistik Durasi Audio (detik):&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">durations_buka</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Buka  - Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">durations_buka</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">durations_buka</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Min: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">durations_buka</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">durations_buka</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">durations_tutup</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tutup - Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">durations_tutup</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">durations_tutup</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Min: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">durations_tutup</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">durations_tutup</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># VISUALISASI DISTRIBUSI DURASI</span>
<span class="c1"># ==========================================================</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">durations_buka</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Buka&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">durations_tutup</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tutup&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Durasi (detik)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frekuensi&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribusi Durasi Audio&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">durations_buka</span><span class="p">,</span> <span class="n">durations_tutup</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Buka&#39;</span><span class="p">,</span> <span class="s1">&#39;Tutup&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Durasi (detik)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot Durasi Audio&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># VISUALISASI SPECTROGRAM</span>
<span class="c1"># ==========================================================</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Contoh Spectrogram dari Dataset&#39;</span><span class="p">)</span>

<span class="c1"># 2 contoh &quot;buka&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">amplitude_to_db</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">librosa</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">audio_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)),</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Buka - </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%+2.0f</span><span class="s1"> dB&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Gagal plot </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="c1"># 2 contoh &quot;tutup&quot;</span>
<span class="n">buka_count</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">buka_count</span> <span class="o">+</span> <span class="n">i</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">amplitude_to_db</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">librosa</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">audio_data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)),</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tutup - </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%+2.0f</span><span class="s1"> dB&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Gagal plot </span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistik Durasi Audio (detik):
Buka  - Mean: 1.801, Std: 1.058, Min: 0.448, Max: 3.867
Tutup - Mean: 1.778, Std: 0.802, Min: 0.448, Max: 3.904
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2240/3803697676.py:35: MatplotlibDeprecationWarning: The &#39;labels&#39; parameter of boxplot() has been renamed &#39;tick_labels&#39; since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  axes[1].boxplot([durations_buka, durations_tutup], labels=[&#39;Buka&#39;, &#39;Tutup&#39;])
</pre></div>
</div>
<img alt="_images/ebe6d6977288a9714cd4da02f1cf452d3ef122859bab3d4e524e5a5976199d8a.png" src="_images/ebe6d6977288a9714cd4da02f1cf452d3ef122859bab3d4e524e5a5976199d8a.png" />
<img alt="_images/4f2fae28ff754dff79f96b1ba73b571064d22311a796ee2085ad03ef86f94800.png" src="_images/4f2fae28ff754dff79f96b1ba73b571064d22311a796ee2085ad03ef86f94800.png" />
</div>
</div>
</section>
<section id="konfigurasi-fitur-tsfel">
<h2>3) Konfigurasi fitur TSFEL<a class="headerlink" href="#konfigurasi-fitur-tsfel" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tsfel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_features_by_domain</span><span class="p">([</span><span class="s2">&quot;statistical&quot;</span><span class="p">])</span>

<span class="c1"># Cek jumlah fitur</span>
<span class="n">n_feats</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_number_features</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah fitur TSFEL yang akan diekstrak: </span><span class="si">{</span><span class="n">n_feats</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Domain yang digunakan:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Jumlah fitur TSFEL yang akan diekstrak: 31
============================================================
Domain yang digunakan: [&#39;statistical&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="ekstraksi-fitur-tsfel-untuk-semua-audio">
<h2>4) Ekstraksi fitur TSFEL untuk semua audio<a class="headerlink" href="#ekstraksi-fitur-tsfel-untuk-semua-audio" title="Permalink to this heading">#</a></h2>
<p>Kita akan mengekstrak fitur untuk setiap file audio menggunakan TSFEL.
Strategi: Ekstrak fitur dari <strong>seluruh sinyal</strong> (full-signal) untuk setiap file audio, sehingga setiap file akan menghasilkan satu vektor fitur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="k">def</span><span class="w"> </span><span class="nf">extract_mfcc_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">n_mfcc</span><span class="o">=</span><span class="mi">13</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ekstrak fitur MFCC dan statistiknya (mean, std, delta)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mfcc</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">mfcc</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">n_mfcc</span><span class="o">=</span><span class="n">n_mfcc</span><span class="p">)</span>
        <span class="n">mfcc_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mfcc_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mfcc_delta</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">delta</span><span class="p">(</span><span class="n">mfcc</span><span class="p">)</span>
        <span class="n">mfcc_delta_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mfcc_delta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">mfcc_mean</span><span class="p">,</span> <span class="n">mfcc_std</span><span class="p">,</span> <span class="n">mfcc_delta_mean</span><span class="p">])</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mfcc_mean_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_mfcc</span><span class="p">)]</span> <span class="o">+</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mfcc_std_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_mfcc</span><span class="p">)]</span> <span class="o">+</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mfcc_delta_mean_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_mfcc</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">feature_names</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Gagal ekstrak MFCC: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n_mfcc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mfcc_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n_mfcc</span><span class="p">)]</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># EKSTRAKSI FITUR TSFEL + MFCC</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔍 Mengekstrak fitur TSFEL + MFCC untuk setiap file audio...&quot;</span><span class="p">)</span>

<span class="n">features_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">valid_filenames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">valid_labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">audio_data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># --- TSFEL features ---</span>
        <span class="n">X_tsfel</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tsfel_feats</span> <span class="o">=</span> <span class="n">X_tsfel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># --- MFCC features ---</span>
        <span class="n">mfcc_feats</span><span class="p">,</span> <span class="n">mfcc_names</span> <span class="o">=</span> <span class="n">extract_mfcc_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">TARGET_SR</span><span class="p">)</span>

        <span class="c1"># Gabungkan keduanya</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tsfel_feats</span><span class="p">,</span> <span class="n">mfcc_feats</span><span class="p">])</span>
        <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>
        <span class="n">valid_filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="n">valid_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Error pada file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_feats</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">mfcc_names</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
        <span class="n">valid_filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="n">valid_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ Ekstraksi fitur selesai untuk </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">features_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> file audio.&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># BUAT DATAFRAME FITUR GABUNGAN</span>
<span class="c1"># ==========================================================</span>
<span class="n">feature_names_tsfel</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_tsfel</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">feature_names_all</span> <span class="o">=</span> <span class="n">feature_names_tsfel</span> <span class="o">+</span> <span class="n">mfcc_names</span>

<span class="n">X_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names_all</span><span class="p">)</span>
<span class="n">X_all</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_labels</span>
<span class="n">X_all</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_filenames</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Shape fitur gabungan: </span><span class="si">{</span><span class="n">X_all</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitur total: </span><span class="si">{</span><span class="n">X_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> features + label + filename&quot;</span><span class="p">)</span>
<span class="n">X_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🔍 Mengekstrak fitur TSFEL + MFCC untuk setiap file audio...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                   | 0/200 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='184',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|▏                                          | 1/200 [00:05&lt;19:08,  5.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='98',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|▍                                          | 2/200 [00:09&lt;15:10,  4.60s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='38',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|▋                                          | 3/200 [00:12&lt;12:59,  3.95s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='141',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|▊                                          | 4/200 [00:16&lt;12:57,  3.96s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|█                                          | 5/200 [00:20&lt;13:00,  4.00s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='152',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█▎                                         | 6/200 [00:24&lt;12:43,  3.93s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='36',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|█▌                                         | 7/200 [00:28&lt;12:11,  3.79s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='142',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|█▋                                         | 8/200 [00:31&lt;12:12,  3.81s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='198',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|█▉                                         | 9/200 [00:36&lt;12:35,  3.96s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='54',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|██                                        | 10/200 [00:39&lt;12:01,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='126',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▎                                       | 11/200 [00:43&lt;11:58,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='63',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▌                                       | 12/200 [00:47&lt;11:47,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='87',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▋                                       | 13/200 [00:50&lt;11:29,  3.69s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|██▉                                       | 14/200 [00:54&lt;11:34,  3.74s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███▏                                      | 15/200 [00:57&lt;11:14,  3.65s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='68',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███▎                                      | 16/200 [01:01&lt;11:05,  3.61s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='36',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███▌                                      | 17/200 [01:04&lt;10:48,  3.54s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|███▊                                      | 18/200 [01:08&lt;10:41,  3.53s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|███▉                                      | 19/200 [01:12&lt;10:45,  3.57s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='46',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████▏                                     | 20/200 [01:15&lt;10:43,  3.58s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████▍                                     | 21/200 [01:19&lt;10:58,  3.68s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='140',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████▌                                     | 22/200 [01:23&lt;10:53,  3.67s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='60',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|████▊                                     | 23/200 [01:26&lt;10:37,  3.60s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='204',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|█████                                     | 24/200 [01:30&lt;10:58,  3.74s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='120',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|█████▎                                    | 25/200 [01:34&lt;10:58,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='90',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|█████▍                                    | 26/200 [01:38&lt;10:41,  3.69s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='126',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|█████▋                                    | 27/200 [01:41&lt;10:42,  3.71s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|█████▉                                    | 28/200 [01:45&lt;10:55,  3.81s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='54',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|██████                                    | 29/200 [01:49&lt;10:43,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='114',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 15%|██████▎                                   | 30/200 [01:52&lt;10:24,  3.68s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='142',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|██████▌                                   | 31/200 [01:56&lt;10:32,  3.75s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='143',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|██████▋                                   | 32/200 [02:01&lt;10:53,  3.89s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='229',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|██████▉                                   | 33/200 [02:06&lt;11:44,  4.22s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='120',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|███████▏                                  | 34/200 [02:10&lt;11:48,  4.27s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='52',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▎                                  | 35/200 [02:14&lt;11:29,  4.18s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='63',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▌                                  | 36/200 [02:18&lt;11:33,  4.23s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▊                                  | 37/200 [02:25&lt;13:32,  4.98s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 19%|███████▉                                  | 38/200 [02:30&lt;13:09,  4.88s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='42',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|████████▏                                 | 39/200 [02:33&lt;12:02,  4.49s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='70',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|████████▍                                 | 40/200 [02:37&lt;11:15,  4.22s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='111',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|████████▌                                 | 41/200 [02:41&lt;10:46,  4.06s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21%|████████▊                                 | 42/200 [02:45&lt;10:47,  4.10s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='96',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████                                 | 43/200 [02:49&lt;10:29,  4.01s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████▏                                | 44/200 [02:52&lt;10:03,  3.87s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='38',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████▍                                | 45/200 [02:55&lt;09:31,  3.69s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='137',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|█████████▋                                | 46/200 [02:59&lt;09:33,  3.72s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='28',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|█████████▊                                | 47/200 [03:03&lt;09:18,  3.65s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='98',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|██████████                                | 48/200 [03:06&lt;09:11,  3.63s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='56',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|██████████▎                               | 49/200 [03:10&lt;08:59,  3.58s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='229',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 25%|██████████▌                               | 50/200 [03:14&lt;09:29,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='158',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██████████▋                               | 51/200 [03:18&lt;09:22,  3.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██████████▉                               | 52/200 [03:21&lt;08:59,  3.64s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='148',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|███████████▏                              | 53/200 [03:25&lt;09:10,  3.74s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 27%|███████████▎                              | 54/200 [03:28&lt;08:45,  3.60s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='90',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 28%|███████████▌                              | 55/200 [03:32&lt;08:42,  3.60s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 28%|███████████▊                              | 56/200 [03:35&lt;08:40,  3.61s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 28%|███████████▉                              | 57/200 [03:39&lt;08:33,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='183',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 29%|████████████▏                             | 58/200 [03:43&lt;08:52,  3.75s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='34',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|████████████▍                             | 59/200 [03:47&lt;08:43,  3.71s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|████████████▌                             | 60/200 [03:50&lt;08:22,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='104',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|████████████▊                             | 61/200 [03:54&lt;08:18,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='70',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 31%|█████████████                             | 62/200 [03:57&lt;08:22,  3.64s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='70',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|█████████████▏                            | 63/200 [04:01&lt;08:21,  3.66s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='85',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|█████████████▍                            | 64/200 [04:05&lt;08:24,  3.71s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='166',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|█████████████▋                            | 65/200 [04:09&lt;08:34,  3.81s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='44',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|█████████████▊                            | 66/200 [04:12&lt;07:55,  3.55s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='142',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 34%|██████████████                            | 67/200 [04:16&lt;08:11,  3.70s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='154',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 34%|██████████████▎                           | 68/200 [04:20&lt;08:14,  3.75s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='231',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 34%|██████████████▍                           | 69/200 [04:24&lt;08:30,  3.90s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='91',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 35%|██████████████▋                           | 70/200 [04:28&lt;08:08,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='28',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|██████████████▉                           | 71/200 [04:31&lt;08:09,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='188',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|███████████████                           | 72/200 [04:35&lt;08:13,  3.86s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|███████████████▎                          | 73/200 [04:39&lt;07:59,  3.78s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 37%|███████████████▌                          | 74/200 [04:42&lt;07:42,  3.67s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='223',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|███████████████▊                          | 75/200 [04:47&lt;08:20,  4.00s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='241',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|███████████████▉                          | 76/200 [04:52&lt;08:29,  4.11s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='53',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|████████████████▏                         | 77/200 [04:55&lt;08:02,  3.92s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='134',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 39%|████████████████▍                         | 78/200 [04:59&lt;08:07,  3.99s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='94',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|████████████████▌                         | 79/200 [05:03&lt;07:49,  3.88s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='231',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|████████████████▊                         | 80/200 [05:07&lt;08:03,  4.03s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='229',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|█████████████████                         | 81/200 [05:11&lt;07:44,  3.90s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='116',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 41%|█████████████████▏                        | 82/200 [05:14&lt;07:15,  3.69s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='98',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 42%|█████████████████▍                        | 83/200 [05:17&lt;06:51,  3.51s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 42%|█████████████████▋                        | 84/200 [05:21&lt;06:52,  3.56s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='54',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 42%|█████████████████▊                        | 85/200 [05:24&lt;06:31,  3.41s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='46',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 43%|██████████████████                        | 86/200 [05:27&lt;06:07,  3.23s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='176',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|██████████████████▎                       | 87/200 [05:30&lt;06:19,  3.36s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='212',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|██████████████████▍                       | 88/200 [05:34&lt;06:30,  3.49s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='58',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|██████████████████▋                       | 89/200 [05:37&lt;06:08,  3.32s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='64',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 45%|██████████████████▉                       | 90/200 [05:40&lt;06:00,  3.28s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='62',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 46%|███████████████████                       | 91/200 [05:43&lt;05:49,  3.20s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='229',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 46%|███████████████████▎                      | 92/200 [05:47&lt;06:04,  3.38s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='194',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 46%|███████████████████▌                      | 93/200 [05:51&lt;06:15,  3.51s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='142',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 47%|███████████████████▋                      | 94/200 [05:54&lt;06:09,  3.49s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='54',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|███████████████████▉                      | 95/200 [05:57&lt;05:49,  3.33s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|████████████████████▏                     | 96/200 [06:00&lt;05:37,  3.24s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='70',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|████████████████████▎                     | 97/200 [06:03&lt;05:30,  3.21s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='240',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 49%|████████████████████▌                     | 98/200 [06:08&lt;06:05,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='68',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|████████████████████▊                     | 99/200 [06:14&lt;07:08,  4.24s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='64',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|████████████████████▌                    | 100/200 [06:17&lt;06:44,  4.04s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='86',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|████████████████████▋                    | 101/200 [06:20&lt;06:18,  3.82s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='200',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 51%|████████████████████▉                    | 102/200 [06:24&lt;06:09,  3.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='80',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 52%|█████████████████████                    | 103/200 [06:27&lt;05:42,  3.54s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='90',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 52%|█████████████████████▎                   | 104/200 [06:30&lt;05:34,  3.49s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='244',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 52%|█████████████████████▌                   | 105/200 [06:34&lt;05:40,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='72',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|█████████████████████▋                   | 106/200 [06:37&lt;05:20,  3.41s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 54%|█████████████████████▉                   | 107/200 [06:41&lt;05:22,  3.47s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='50',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 54%|██████████████████████▏                  | 108/200 [06:44&lt;05:03,  3.30s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='50',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 55%|██████████████████████▎                  | 109/200 [06:47&lt;04:51,  3.20s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='128',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 55%|██████████████████████▌                  | 110/200 [06:50&lt;04:46,  3.18s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='80',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|██████████████████████▊                  | 111/200 [06:53&lt;04:44,  3.20s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='184',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|██████████████████████▉                  | 112/200 [06:57&lt;04:50,  3.30s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='124',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|███████████████████████▏                 | 113/200 [07:00&lt;04:48,  3.32s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='166',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 57%|███████████████████████▎                 | 114/200 [07:04&lt;04:49,  3.37s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='56',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 57%|███████████████████████▌                 | 115/200 [07:07&lt;04:39,  3.29s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='132',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 58%|███████████████████████▊                 | 116/200 [07:13&lt;05:52,  4.20s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='94',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 58%|███████████████████████▉                 | 117/200 [07:17&lt;05:39,  4.09s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 59%|████████████████████████▏                | 118/200 [07:20&lt;05:13,  3.82s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='82',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|████████████████████████▍                | 119/200 [07:23&lt;04:53,  3.62s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='112',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|████████████████████████▌                | 120/200 [07:26&lt;04:41,  3.51s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='190',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|████████████████████████▊                | 121/200 [07:30&lt;04:36,  3.50s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 61%|█████████████████████████                | 122/200 [07:33&lt;04:29,  3.46s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='152',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 62%|█████████████████████████▏               | 123/200 [07:37&lt;04:24,  3.44s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='80',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 62%|█████████████████████████▍               | 124/200 [07:40&lt;04:10,  3.30s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='114',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 62%|█████████████████████████▋               | 125/200 [07:43&lt;04:06,  3.28s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='90',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 63%|█████████████████████████▊               | 126/200 [07:46&lt;04:02,  3.27s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='145',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|██████████████████████████               | 127/200 [07:50&lt;04:02,  3.32s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='100',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|██████████████████████████▏              | 128/200 [07:53&lt;03:53,  3.25s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='94',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|██████████████████████████▍              | 129/200 [07:56&lt;03:50,  3.25s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 65%|██████████████████████████▋              | 130/200 [07:59&lt;03:42,  3.17s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='86',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 66%|██████████████████████████▊              | 131/200 [08:02&lt;03:36,  3.13s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='180',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 66%|███████████████████████████              | 132/200 [08:05&lt;03:41,  3.26s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='148',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 66%|███████████████████████████▎             | 133/200 [08:11&lt;04:28,  4.01s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='186',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|███████████████████████████▍             | 134/200 [08:17&lt;04:52,  4.44s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68%|███████████████████████████▋             | 135/200 [08:20&lt;04:34,  4.22s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='92',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68%|███████████████████████████▉             | 136/200 [08:24&lt;04:18,  4.05s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68%|████████████████████████████             | 137/200 [08:28&lt;04:10,  3.97s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 69%|████████████████████████████▎            | 138/200 [08:31&lt;03:58,  3.85s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='100',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|████████████████████████████▍            | 139/200 [08:35&lt;03:50,  3.78s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='36',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|████████████████████████████▋            | 140/200 [08:39&lt;03:42,  3.71s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='152',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|████████████████████████████▉            | 141/200 [08:42&lt;03:39,  3.72s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='64',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 71%|█████████████████████████████            | 142/200 [08:46&lt;03:36,  3.74s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 72%|█████████████████████████████▎           | 143/200 [08:50&lt;03:27,  3.65s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 72%|█████████████████████████████▌           | 144/200 [08:53&lt;03:21,  3.59s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='166',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 72%|█████████████████████████████▋           | 145/200 [08:57&lt;03:26,  3.75s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='82',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 73%|█████████████████████████████▉           | 146/200 [09:01&lt;03:20,  3.71s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='124',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|██████████████████████████████▏          | 147/200 [09:04&lt;03:17,  3.72s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='202',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|██████████████████████████████▎          | 148/200 [09:09&lt;03:22,  3.89s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='100',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|██████████████████████████████▌          | 149/200 [09:12&lt;03:16,  3.85s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='172',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 75%|██████████████████████████████▊          | 150/200 [09:16&lt;03:13,  3.87s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='66',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|██████████████████████████████▉          | 151/200 [09:20&lt;03:07,  3.82s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='130',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|███████████████████████████████▏         | 152/200 [09:24&lt;03:04,  3.84s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='94',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|███████████████████████████████▎         | 153/200 [09:27&lt;02:49,  3.61s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 77%|███████████████████████████████▌         | 154/200 [09:31&lt;02:48,  3.66s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='88',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|███████████████████████████████▊         | 155/200 [09:35&lt;02:47,  3.72s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='150',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|███████████████████████████████▉         | 156/200 [09:39&lt;02:49,  3.85s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='70',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|████████████████████████████████▏        | 157/200 [09:42&lt;02:41,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='160',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 79%|████████████████████████████████▍        | 158/200 [09:46&lt;02:39,  3.81s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='36',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 80%|████████████████████████████████▌        | 159/200 [09:50&lt;02:34,  3.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='148',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 80%|████████████████████████████████▊        | 160/200 [09:54&lt;02:30,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='88',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 80%|█████████████████████████████████        | 161/200 [09:58&lt;02:26,  3.76s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='152',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 81%|█████████████████████████████████▏       | 162/200 [10:02&lt;02:26,  3.86s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='64',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|█████████████████████████████████▍       | 163/200 [10:05&lt;02:18,  3.75s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='148',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|█████████████████████████████████▌       | 164/200 [10:09&lt;02:16,  3.79s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|█████████████████████████████████▊       | 165/200 [10:12&lt;02:06,  3.61s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='176',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 83%|██████████████████████████████████       | 166/200 [10:17&lt;02:10,  3.84s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='84',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|██████████████████████████████████▏      | 167/200 [10:20&lt;02:07,  3.86s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='96',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|██████████████████████████████████▍      | 168/200 [10:24&lt;02:01,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='100',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|██████████████████████████████████▋      | 169/200 [10:27&lt;01:53,  3.66s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='74',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 85%|██████████████████████████████████▊      | 170/200 [10:32&lt;01:53,  3.79s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='180',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 86%|███████████████████████████████████      | 171/200 [10:36&lt;01:51,  3.86s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 86%|███████████████████████████████████▎     | 172/200 [10:39&lt;01:46,  3.81s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='32',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 86%|███████████████████████████████████▍     | 173/200 [10:42&lt;01:37,  3.62s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='114',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 87%|███████████████████████████████████▋     | 174/200 [10:47&lt;01:38,  3.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='172',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|███████████████████████████████████▉     | 175/200 [10:51&lt;01:36,  3.86s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='154',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|████████████████████████████████████     | 176/200 [10:55&lt;01:34,  3.94s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='114',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|████████████████████████████████████▎    | 177/200 [10:58&lt;01:29,  3.88s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 89%|████████████████████████████████████▍    | 178/200 [11:02&lt;01:25,  3.87s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='114',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|████████████████████████████████████▋    | 179/200 [11:06&lt;01:20,  3.83s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='162',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|████████████████████████████████████▉    | 180/200 [11:10&lt;01:18,  3.92s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='152',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|█████████████████████████████████████    | 181/200 [11:14&lt;01:14,  3.95s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='116',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 91%|█████████████████████████████████████▎   | 182/200 [11:18&lt;01:10,  3.91s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='34',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|█████████████████████████████████████▌   | 183/200 [11:21&lt;01:04,  3.77s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='166',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|█████████████████████████████████████▋   | 184/200 [11:26&lt;01:01,  3.85s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='174',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|█████████████████████████████████████▉   | 185/200 [11:30&lt;00:59,  3.94s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='50',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 93%|██████████████████████████████████████▏  | 186/200 [11:33&lt;00:54,  3.90s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='137',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|██████████████████████████████████████▎  | 187/200 [11:37&lt;00:50,  3.88s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='66',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|██████████████████████████████████████▌  | 188/200 [11:41&lt;00:45,  3.80s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='202',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|██████████████████████████████████████▋  | 189/200 [11:45&lt;00:43,  3.95s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='28',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 95%|██████████████████████████████████████▉  | 190/200 [11:48&lt;00:37,  3.74s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='54',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 96%|███████████████████████████████████████▏ | 191/200 [11:52&lt;00:32,  3.66s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='162',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 96%|███████████████████████████████████████▎ | 192/200 [11:56&lt;00:30,  3.84s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='166',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 96%|███████████████████████████████████████▌ | 193/200 [12:00&lt;00:27,  3.90s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='34',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 97%|███████████████████████████████████████▊ | 194/200 [12:03&lt;00:22,  3.70s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='155',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|███████████████████████████████████████▉ | 195/200 [12:08&lt;00:19,  3.82s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='30',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|████████████████████████████████████████▏| 196/200 [12:11&lt;00:14,  3.72s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='50',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|████████████████████████████████████████▍| 197/200 [12:15&lt;00:10,  3.64s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='102',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 99%|████████████████████████████████████████▌| 198/200 [12:18&lt;00:07,  3.69s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='216',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|████████████████████████████████████████▊| 199/200 [12:23&lt;00:03,  3.84s/it]
</pre></div>
</div>
<div class="output text_html">
              <p>
                  Progress: 0% Complete
              <p/>
              <progress
                  value='0'
                  max='137',
                  style='width: 25%',
              >
                  0
              </progress>

    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 200/200 [12:27&lt;00:00,  3.74s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Ekstraksi fitur selesai untuk 200 file audio.

Shape fitur gabungan: (200, 72)
Fitur total: 70 features + label + filename
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_Absolute energy</th>
      <th>0_Average power</th>
      <th>0_ECDF Percentile Count_0</th>
      <th>0_ECDF Percentile Count_1</th>
      <th>0_ECDF Percentile_0</th>
      <th>0_ECDF Percentile_1</th>
      <th>0_ECDF_0</th>
      <th>0_ECDF_1</th>
      <th>0_ECDF_2</th>
      <th>0_ECDF_3</th>
      <th>...</th>
      <th>mfcc_delta_mean_6</th>
      <th>mfcc_delta_mean_7</th>
      <th>mfcc_delta_mean_8</th>
      <th>mfcc_delta_mean_9</th>
      <th>mfcc_delta_mean_10</th>
      <th>mfcc_delta_mean_11</th>
      <th>mfcc_delta_mean_12</th>
      <th>mfcc_delta_mean_13</th>
      <th>label</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.151500</td>
      <td>9.505881</td>
      <td>51.0</td>
      <td>204.0</td>
      <td>-0.027050</td>
      <td>0.011637</td>
      <td>0.003906</td>
      <td>0.007812</td>
      <td>0.011719</td>
      <td>0.015625</td>
      <td>...</td>
      <td>0.002784</td>
      <td>-0.061914</td>
      <td>-0.004277</td>
      <td>-0.050556</td>
      <td>-0.144178</td>
      <td>-0.093542</td>
      <td>-0.053490</td>
      <td>-0.042096</td>
      <td>0</td>
      <td>buka1.wav</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.096116</td>
      <td>6.030810</td>
      <td>51.0</td>
      <td>204.0</td>
      <td>-0.019492</td>
      <td>0.015389</td>
      <td>0.003906</td>
      <td>0.007812</td>
      <td>0.011719</td>
      <td>0.015625</td>
      <td>...</td>
      <td>0.611346</td>
      <td>-0.217574</td>
      <td>0.202217</td>
      <td>0.383730</td>
      <td>0.284805</td>
      <td>0.729074</td>
      <td>0.160276</td>
      <td>0.061467</td>
      <td>0</td>
      <td>buka10.wav</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000021</td>
      <td>0.001346</td>
      <td>51.0</td>
      <td>204.0</td>
      <td>-0.000215</td>
      <td>0.000145</td>
      <td>0.003906</td>
      <td>0.007812</td>
      <td>0.011719</td>
      <td>0.015625</td>
      <td>...</td>
      <td>1.380890</td>
      <td>1.228462</td>
      <td>0.900800</td>
      <td>0.913053</td>
      <td>2.618159</td>
      <td>0.647516</td>
      <td>1.527186</td>
      <td>0.117198</td>
      <td>0</td>
      <td>buka100.wav</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.038662</td>
      <td>2.425821</td>
      <td>51.0</td>
      <td>204.0</td>
      <td>-0.013715</td>
      <td>0.012215</td>
      <td>0.003906</td>
      <td>0.007812</td>
      <td>0.011719</td>
      <td>0.015625</td>
      <td>...</td>
      <td>0.139175</td>
      <td>0.041493</td>
      <td>0.171942</td>
      <td>-0.040368</td>
      <td>0.318290</td>
      <td>0.452866</td>
      <td>0.099699</td>
      <td>0.079890</td>
      <td>0</td>
      <td>buka11.wav</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006540</td>
      <td>0.410381</td>
      <td>51.0</td>
      <td>204.0</td>
      <td>-0.004638</td>
      <td>0.004923</td>
      <td>0.003906</td>
      <td>0.007812</td>
      <td>0.011719</td>
      <td>0.015625</td>
      <td>...</td>
      <td>0.218927</td>
      <td>-0.026375</td>
      <td>-0.012120</td>
      <td>0.031270</td>
      <td>0.079705</td>
      <td>0.217200</td>
      <td>0.083976</td>
      <td>-0.013466</td>
      <td>0</td>
      <td>buka12.wav</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 72 columns</p>
</div></div></div>
</div>
</section>
<section id="bersihkan-fitur-nan-inf-simpan-ke-csv">
<h2>5) Bersihkan fitur (NaN/Inf), simpan ke CSV<a class="headerlink" href="#bersihkan-fitur-nan-inf-simpan-ke-csv" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">X_clean</span> <span class="o">=</span> <span class="n">X_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Ganti nilai inf/-inf menjadi NaN</span>
<span class="n">X_clean</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="c1"># Pisahkan label &amp; filename</span>
<span class="n">y_labels</span> <span class="o">=</span> <span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">file_names</span> <span class="o">=</span> <span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Ambil hanya fitur numerik</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># --- Tahap 1: Hapus kolom yang seluruhnya NaN ---</span>
<span class="n">drop_all_nan</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">X_features</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()]</span>
<span class="k">if</span> <span class="n">drop_all_nan</span><span class="p">:</span>
    <span class="n">X_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">drop_all_nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- Tahap 2: Hapus kolom yang sebagian NaN (bisa diganti imputasi median) ---</span>
<span class="n">drop_any_nan</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">X_features</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
<span class="k">if</span> <span class="n">drop_any_nan</span><span class="p">:</span>
    <span class="n">X_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">drop_any_nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- Tahap 3: Hapus kolom dengan variansi 0 ---</span>
<span class="n">zero_var_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">X_features</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">zero_var_cols</span><span class="p">:</span>
    <span class="n">X_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">zero_var_cols</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ringkasan hasil cleaning</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🧹  Hasil pembersihan fitur:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   • Kolom all-NaN      : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_all_nan</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   • Kolom sebagian NaN : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_any_nan</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   • Kolom variansi 0   : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zero_var_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Shape setelah clean  : </span><span class="si">{</span><span class="n">X_features</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Gabungkan kembali dengan label &amp; filename</span>
<span class="n">X_clean</span> <span class="o">=</span> <span class="n">X_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_labels</span>
<span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_names</span>

<span class="c1"># Distribusi label</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Distribusi label:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">X_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🧹  Hasil pembersihan fitur:
   • Kolom all-NaN      : 0
   • Kolom sebagian NaN : 0
   • Kolom variansi 0   : 12
✅ Shape setelah clean  : (200, 58)

📊 Distribusi label:
label
0    100
1    100
Name: count, dtype: int64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_Absolute energy</th>
      <th>0_Average power</th>
      <th>0_ECDF Percentile_0</th>
      <th>0_ECDF Percentile_1</th>
      <th>0_Entropy</th>
      <th>0_Histogram mode</th>
      <th>0_Interquartile range</th>
      <th>0_Kurtosis</th>
      <th>0_Max</th>
      <th>0_Mean</th>
      <th>...</th>
      <th>mfcc_delta_mean_6</th>
      <th>mfcc_delta_mean_7</th>
      <th>mfcc_delta_mean_8</th>
      <th>mfcc_delta_mean_9</th>
      <th>mfcc_delta_mean_10</th>
      <th>mfcc_delta_mean_11</th>
      <th>mfcc_delta_mean_12</th>
      <th>mfcc_delta_mean_13</th>
      <th>label</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.151500</td>
      <td>9.505881</td>
      <td>-0.027050</td>
      <td>0.011637</td>
      <td>1.0</td>
      <td>-0.013010</td>
      <td>0.030883</td>
      <td>-0.133537</td>
      <td>0.055799</td>
      <td>-0.007703</td>
      <td>...</td>
      <td>0.002784</td>
      <td>-0.061914</td>
      <td>-0.004277</td>
      <td>-0.050556</td>
      <td>-0.144178</td>
      <td>-0.093542</td>
      <td>-0.053490</td>
      <td>-0.042096</td>
      <td>0</td>
      <td>buka1.wav</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.096116</td>
      <td>6.030810</td>
      <td>-0.019492</td>
      <td>0.015389</td>
      <td>1.0</td>
      <td>-0.018041</td>
      <td>0.031972</td>
      <td>0.148510</td>
      <td>0.072070</td>
      <td>-0.000787</td>
      <td>...</td>
      <td>0.611346</td>
      <td>-0.217574</td>
      <td>0.202217</td>
      <td>0.383730</td>
      <td>0.284805</td>
      <td>0.729074</td>
      <td>0.160276</td>
      <td>0.061467</td>
      <td>0</td>
      <td>buka10.wav</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000021</td>
      <td>0.001346</td>
      <td>-0.000215</td>
      <td>0.000145</td>
      <td>1.0</td>
      <td>-0.000103</td>
      <td>0.000226</td>
      <td>0.677275</td>
      <td>0.000818</td>
      <td>-0.000009</td>
      <td>...</td>
      <td>1.380890</td>
      <td>1.228462</td>
      <td>0.900800</td>
      <td>0.913053</td>
      <td>2.618159</td>
      <td>0.647516</td>
      <td>1.527186</td>
      <td>0.117198</td>
      <td>0</td>
      <td>buka100.wav</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.038662</td>
      <td>2.425821</td>
      <td>-0.013715</td>
      <td>0.012215</td>
      <td>1.0</td>
      <td>0.013510</td>
      <td>0.022572</td>
      <td>-1.174062</td>
      <td>0.020634</td>
      <td>-0.000358</td>
      <td>...</td>
      <td>0.139175</td>
      <td>0.041493</td>
      <td>0.171942</td>
      <td>-0.040368</td>
      <td>0.318290</td>
      <td>0.452866</td>
      <td>0.099699</td>
      <td>0.079890</td>
      <td>0</td>
      <td>buka11.wav</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006540</td>
      <td>0.410381</td>
      <td>-0.004638</td>
      <td>0.004923</td>
      <td>1.0</td>
      <td>-0.003178</td>
      <td>0.007968</td>
      <td>-0.888179</td>
      <td>0.012387</td>
      <td>0.000340</td>
      <td>...</td>
      <td>0.218927</td>
      <td>-0.026375</td>
      <td>-0.012120</td>
      <td>0.031270</td>
      <td>0.079705</td>
      <td>0.217200</td>
      <td>0.083976</td>
      <td>-0.013466</td>
      <td>0</td>
      <td>buka12.wav</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 60 columns</p>
</div></div></div>
</div>
</section>
<section id="standarisasi-visualisasi-pca-2d">
<h2>6) Standarisasi &amp; visualisasi (PCA 2D)<a class="headerlink" href="#standarisasi-visualisasi-pca-2d" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># PCA VISUALISASI FITUR GABUNGAN (TSFEL + MFCC)</span>
<span class="c1"># ==========================================================</span>

<span class="c1"># Pastikan DataFrame berasal dari hasil gabungan TSFEL + MFCC</span>
<span class="n">X_clean</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Pisahkan fitur dan label</span>
<span class="n">X_for_scaling</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_for_viz</span> <span class="o">=</span> <span class="n">X_clean</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># --- 🔧 Imputasi nilai NaN ---</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>  <span class="c1"># alternatif: &#39;mean&#39;</span>
<span class="n">X_imputed</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_for_scaling</span><span class="p">)</span>

<span class="c1"># --- Standarisasi fitur ---</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_imputed</span><span class="p">)</span>

<span class="c1"># --- PCA ke 2 dimensi ---</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="c1"># --- Visualisasi hasil PCA ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">]</span>
<span class="n">labels_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Buka&#39;</span><span class="p">,</span> <span class="s1">&#39;Tutup&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels_name</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_for_viz</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">y_for_viz</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">y_for_viz</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Z2</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Z2</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PCA 2D – Fitur Gabungan TSFEL + MFCC</span><span class="se">\n</span><span class="s2">(Explained Variance: </span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC1 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC2 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- Simpan hasil ke CSV ---</span>
<span class="n">out_csv</span> <span class="o">=</span> <span class="s2">&quot;voice_features_tsfel_mfcc.csv&quot;</span>
<span class="n">X_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">out_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ Fitur gabungan tersimpan.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📁 Lokasi file: </span><span class="si">{</span><span class="n">out_csv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📊 Total sampel: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_clean</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚙️  Total fitur (tanpa label &amp; filename): </span><span class="si">{</span><span class="n">X_clean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📈 Explained variance PCA total: </span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6ca0dc87d4cb8cff7ef4437406d460bdbf1c30a76442909bf5e8e87169844110.png" src="_images/6ca0dc87d4cb8cff7ef4437406d460bdbf1c30a76442909bf5e8e87169844110.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Fitur gabungan tersimpan.
📁 Lokasi file: voice_features_tsfel_mfcc.csv
📊 Total sampel: 200
⚙️  Total fitur (tanpa label &amp; filename): 58
📈 Explained variance PCA total: 37.64%
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-dengan-berbagai-algoritma">
<h2>7) Klasifikasi dengan berbagai algoritma<a class="headerlink" href="#klasifikasi-dengan-berbagai-algoritma" title="Permalink to this heading">#</a></h2>
<p>Kita akan menguji beberapa model klasifikasi untuk membedakan suara “buka” dan “tutup”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 KONFIGURASI UMUM</span>
<span class="c1"># ==========================================================</span>
<span class="n">TARGET_SR</span> <span class="o">=</span> <span class="mi">16000</span>
<span class="n">FEATURE_FILE</span> <span class="o">=</span> <span class="s2">&quot;voice_features_tsfel_mfcc.csv&quot;</span>
<span class="n">ARTIFACT_DIR</span> <span class="o">=</span> <span class="s2">&quot;artifacts&quot;</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 LOAD DATASET FITUR</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📂 Loading feature dataset...&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FEATURE_FILE</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;File fitur tidak ditemukan: </span><span class="si">{</span><span class="n">FEATURE_FILE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FEATURE_FILE</span><span class="p">)</span>

<span class="k">assert</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Kolom &#39;label&#39; tidak ditemukan!&quot;</span>
<span class="k">assert</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Kolom &#39;filename&#39; tidak ditemukan!&quot;</span>

<span class="c1"># Pisahkan fitur dan label</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Dataset loaded: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔸 Total features digunakan untuk training: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Contoh fitur: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 SPLIT DATA TRAIN &amp; TEST</span>
<span class="c1"># ==========================================================</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Data split -&gt; Train: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, Test: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 SCALING FITUR</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">⚙️ Scaling features...&quot;</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Feature scaling completed.&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 TRAINING RANDOM FOREST</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🌳 Training RandomForestClassifier...&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 EVALUASI MODEL</span>
<span class="c1"># ==========================================================</span>
<span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="n">train_score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">)</span>
<span class="n">test_score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ Training accuracy : </span><span class="si">{</span><span class="n">train_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Test accuracy     : </span><span class="si">{</span><span class="n">test_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📈 Classification Report:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))</span>

<span class="c1"># (Opsional) Top 10 fitur terpenting</span>
<span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">top_features</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔍 10 Fitur Terpenting:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top_features</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 SIMPAN ARTIFACTS</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">💾 Saving model artifacts...&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ARTIFACT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Model &amp; scaler</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/voice_classifier_model.pkl&quot;</span><span class="p">)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/voice_scaler.pkl&quot;</span><span class="p">)</span>

<span class="c1"># Nama fitur</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">feature_names</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/feature_names.pkl&quot;</span><span class="p">)</span>

<span class="c1"># Simpan konfigurasi TSFEL jika ada</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;tsfel_config.pkl&quot;</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;tsfel_config.pkl&quot;</span><span class="p">)</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/tsfel_config.pkl&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Model, scaler, dan fitur tersimpan di folder: &#39;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/&#39;&quot;</span><span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔹 SIMPAN METADATA</span>
<span class="c1"># ==========================================================</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;target_sr&quot;</span><span class="p">:</span> <span class="n">TARGET_SR</span><span class="p">,</span>
    <span class="s2">&quot;n_features&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">),</span>
    <span class="s2">&quot;train_accuracy&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">train_score</span><span class="p">),</span>
    <span class="s2">&quot;test_accuracy&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">test_score</span><span class="p">),</span>
    <span class="s2">&quot;label_map&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Buka&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Tutup&quot;</span><span class="p">},</span>
    <span class="s2">&quot;feature_source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TSFEL&quot;</span><span class="p">,</span> <span class="s2">&quot;MFCC&quot;</span><span class="p">],</span>
    <span class="s2">&quot;top_features&quot;</span><span class="p">:</span> <span class="n">top_features</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
<span class="p">}</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/model_metadata.pkl&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ARTIFACT_DIR</span><span class="si">}</span><span class="s2">/model_metadata.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Metadata saved (model_metadata.pkl &amp; model_metadata.json)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ All artifacts saved successfully in folder &#39;artifacts/&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>📂 Loading feature dataset...
✅ Dataset loaded: (200, 58)
🔸 Total features digunakan untuk training: 58
   Contoh fitur: [&#39;0_Absolute energy&#39;, &#39;0_Average power&#39;, &#39;0_ECDF Percentile_0&#39;, &#39;0_ECDF Percentile_1&#39;, &#39;0_Entropy&#39;]

📊 Data split -&gt; Train: (160, 58), Test: (40, 58)

⚙️ Scaling features...
✓ Feature scaling completed.

🌳 Training RandomForestClassifier...

✅ Training accuracy : 1.0000
✅ Test accuracy     : 1.0000

📈 Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00        20
           1       1.00      1.00      1.00        20

    accuracy                           1.00        40
   macro avg       1.00      1.00      1.00        40
weighted avg       1.00      1.00      1.00        40


🔍 10 Fitur Terpenting:
mfcc_mean_10         0.105691
mfcc_std_3           0.105144
mfcc_mean_5          0.094488
mfcc_mean_11         0.065327
mfcc_delta_mean_6    0.061958
mfcc_mean_4          0.058707
mfcc_mean_6          0.056548
mfcc_mean_3          0.039498
mfcc_mean_12         0.033616
mfcc_std_4           0.033386
dtype: float64

💾 Saving model artifacts...
✓ Model, scaler, dan fitur tersimpan di folder: &#39;artifacts/&#39;
✓ Metadata saved (model_metadata.pkl &amp; model_metadata.json)

============================================================
✅ All artifacts saved successfully in folder &#39;artifacts/&#39;
============================================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> app.py
<span class="kn">import</span><span class="w"> </span><span class="nn">streamlit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tsfel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">soundfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">audio_recorder_streamlit</span><span class="w"> </span><span class="kn">import</span> <span class="n">audio_recorder</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🎛️ Konfigurasi halaman</span>
<span class="c1"># ==========================================================</span>
<span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s2">&quot;Klasifikasi Suara Buka/Tutup&quot;</span><span class="p">,</span>
    <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;🎙️&quot;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span>
<span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 📦 Load model dan artefak</span>
<span class="c1"># ==========================================================</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">cache_resource</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_model_artifacts</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/voice_classifier_model.pkl&#39;</span><span class="p">)</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/voice_scaler.pkl&#39;</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/feature_names.pkl&#39;</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/model_metadata.pkl&#39;</span><span class="p">)</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_features_by_domain</span><span class="p">([</span><span class="s2">&quot;statistical&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">cfg</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🎚️ Preprocessing audio</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">target_sr</span><span class="o">=</span><span class="mi">16000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resample, trim, dan normalisasi audio&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File audio kosong atau tidak terbaca.&quot;</span><span class="p">)</span>

    <span class="c1"># Resample jika perlu</span>
    <span class="k">if</span> <span class="n">sr</span> <span class="o">!=</span> <span class="n">target_sr</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">orig_sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">target_sr</span><span class="o">=</span><span class="n">target_sr</span><span class="p">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">target_sr</span>

    <span class="c1"># Trim (hapus bagian diam)</span>
    <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">effects</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">top_db</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

    <span class="c1"># Normalisasi amplitudo</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y_trimmed</span> <span class="o">=</span> <span class="n">y_trimmed</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sr</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Audio terlalu pendek setelah trimming.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">sr</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🔍 Ekstraksi fitur gabungan (TSFEL + MFCC)</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_combined_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ekstraksi fitur gabungan TSFEL + MFCC&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Audio terlalu pendek (len=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># --- TSFEL (statistical domain) ---</span>
        <span class="n">X_tsfel</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">X_tsfel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Hasil ekstraksi TSFEL kosong.&quot;</span><span class="p">)</span>
        <span class="n">tsfel_feats</span> <span class="o">=</span> <span class="n">X_tsfel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># --- MFCC ringkas ---</span>
        <span class="n">mfcc</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">mfcc</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">n_mfcc</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">mfcc_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mfcc_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mfcc_feats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">mfcc_mean</span><span class="p">,</span> <span class="n">mfcc_std</span><span class="p">])</span>

        <span class="c1"># --- Gabungkan ---</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tsfel_feats</span><span class="p">,</span> <span class="n">mfcc_feats</span><span class="p">])</span>

        <span class="c1"># Samakan panjang</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">):</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">all_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_features</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">all_features</span> <span class="o">=</span> <span class="n">all_features</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">all_features</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Error ekstraksi fitur: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🧠 Prediksi</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predict_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y_proc</span><span class="p">,</span> <span class="n">sr_proc</span> <span class="o">=</span> <span class="n">preprocess_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;target_sr&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_proc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;⚠️ Audio terlalu pendek setelah preprocessing.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">extract_combined_features</span><span class="p">(</span><span class="n">y_proc</span><span class="p">,</span> <span class="n">sr_proc</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="n">features_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
        <span class="n">features_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">features_df</span><span class="p">)</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">y_proc</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Error prediksi: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🎧 Visualisasi audio</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_waveform_and_spectrogram</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">waveshow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Waveform&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Waktu (detik)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitudo&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">amplitude_to_db</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">librosa</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)),</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Spectrogram (dB)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%+2.0f</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🚀 Main App</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;🎙️ Klasifikasi Suara Buka/Tutup&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Aplikasi ini mengklasifikasikan suara menjadi **Buka** atau **Tutup** </span>
<span class="s2">    menggunakan model Machine Learning berbasis **TSFEL + MFCC + Random Forest**.</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;🔄 Memuat model...&quot;</span><span class="p">):</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">load_model_artifacts</span><span class="p">()</span>

    <span class="c1"># Sidebar informasi</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;📊 Informasi Model&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Akurasi Training:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;train_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Akurasi Testing:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;test_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Jumlah Fitur:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;n_features&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Sample Rate:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target_sr&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;ℹ️ Petunjuk&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    1. Rekam atau upload suara (.wav / .mp3)  </span>
<span class="s2">    2. Klik **Prediksi**  </span>
<span class="s2">    3. Lihat hasil dan visualisasi  </span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;🎤 Rekam atau Upload Suara&quot;</span><span class="p">)</span>

    <span class="n">option</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span><span class="s2">&quot;Pilih sumber audio:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;🎙️ Rekam Langsung&quot;</span><span class="p">,</span> <span class="s2">&quot;📁 Upload File&quot;</span><span class="p">])</span>
    <span class="n">audio_data</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;🎙️ Rekam Langsung&quot;</span><span class="p">:</span>
        <span class="n">audio_bytes</span> <span class="o">=</span> <span class="n">audio_recorder</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Klik untuk mulai/stop rekam&quot;</span><span class="p">,</span>
            <span class="n">recording_color</span><span class="o">=</span><span class="s2">&quot;#e74c3c&quot;</span><span class="p">,</span>
            <span class="n">neutral_color</span><span class="o">=</span><span class="s2">&quot;#3498db&quot;</span><span class="p">,</span>
            <span class="n">icon_size</span><span class="o">=</span><span class="s2">&quot;2x&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">audio_bytes</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.wav&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">tmp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">audio_bytes</span><span class="p">)</span>
                <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">y</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">audio</span><span class="p">(</span><span class="n">audio_bytes</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;audio/wav&quot;</span><span class="p">)</span>
                <span class="n">audio_data</span> <span class="o">=</span> <span class="n">y</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">file_uploader</span><span class="p">(</span><span class="s2">&quot;📁 Upload file audio&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wav&quot;</span><span class="p">,</span> <span class="s2">&quot;mp3&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">uploaded_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.wav&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">tmp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">uploaded_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">y</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">audio</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;audio/wav&quot;</span><span class="p">)</span>
                <span class="n">audio_data</span> <span class="o">=</span> <span class="n">y</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># 🔍 Tombol Prediksi</span>
    <span class="c1"># ==========================================</span>
    <span class="k">if</span> <span class="n">audio_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">durasi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">sr</span>
        <span class="n">st</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Durasi audio: **</span><span class="si">{</span><span class="n">durasi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> detik**  |  Sample rate: **</span><span class="si">{</span><span class="n">sr</span><span class="si">}</span><span class="s2"> Hz**&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;⚠️ Audio terlalu pendek. Mohon rekam ulang minimal 0.5 detik.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;🔍 Prediksi&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;🔎 Memproses dan memprediksi...&quot;</span><span class="p">):</span>
                <span class="n">pred</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">y_proc</span> <span class="o">=</span> <span class="n">predict_audio</span><span class="p">(</span><span class="n">audio_data</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pred</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;label_map&quot;</span><span class="p">][</span><span class="n">pred</span><span class="p">]</span>
                    <span class="n">confidence</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Prediksi:** </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

                    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;#### Probabilitas:&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;label_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">progress</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_waveform_and_spectrogram</span><span class="p">(</span><span class="n">y_proc</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;target_sr&quot;</span><span class="p">])</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting app.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> app.py
<span class="kn">import</span><span class="w"> </span><span class="nn">streamlit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tsfel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydub</span><span class="w"> </span><span class="kn">import</span> <span class="n">AudioSegment</span>  <span class="c1"># ✅ untuk membaca mp3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">soundfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sf</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 🎛️ Konfigurasi halaman</span>
<span class="c1"># ==========================================================</span>
<span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s2">&quot;Klasifikasi Suara Buka/Tutup&quot;</span><span class="p">,</span>
    <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;🎙️&quot;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span>
<span class="p">)</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 📦 Load model dan artefak</span>
<span class="c1"># ==========================================================</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">cache_resource</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_model_artifacts</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/voice_classifier_model.pkl&#39;</span><span class="p">)</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/voice_scaler.pkl&#39;</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/feature_names.pkl&#39;</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;artifacts/model_metadata.pkl&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># 🎚️ Preprocessing audio</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">target_sr</span><span class="o">=</span><span class="mi">16000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resample, trim, dan normalisasi audio&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File audio kosong atau tidak terbaca.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sr</span> <span class="o">!=</span> <span class="n">target_sr</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">orig_sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">target_sr</span><span class="o">=</span><span class="n">target_sr</span><span class="p">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">target_sr</span>
    <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">effects</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">top_db</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y_trimmed</span> <span class="o">=</span> <span class="n">y_trimmed</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_trimmed</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sr</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Audio terlalu pendek setelah trimming.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_trimmed</span><span class="p">,</span> <span class="n">sr</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># 🔍 Ekstraksi fitur (TSFEL + MFCC)</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_mfcc_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">n_mfcc</span><span class="o">=</span><span class="mi">13</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ekstrak fitur MFCC: mean, std, delta mean&quot;&quot;&quot;</span>
    <span class="n">mfcc</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">mfcc</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">n_mfcc</span><span class="o">=</span><span class="n">n_mfcc</span><span class="p">)</span>
    <span class="n">mfcc_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mfcc_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mfcc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mfcc_delta</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">delta</span><span class="p">(</span><span class="n">mfcc</span><span class="p">)</span>
    <span class="n">mfcc_delta_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mfcc_delta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">mfcc_mean</span><span class="p">,</span> <span class="n">mfcc_std</span><span class="p">,</span> <span class="n">mfcc_delta_mean</span><span class="p">])</span>


<span class="k">def</span><span class="w"> </span><span class="nf">extract_combined_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ekstraksi fitur gabungan TSFEL + MFCC&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_features_by_domain</span><span class="p">([</span><span class="s2">&quot;statistical&quot;</span><span class="p">])</span>
        <span class="n">X_tsfel</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tsfel_feats</span> <span class="o">=</span> <span class="n">X_tsfel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">mfcc_feats</span> <span class="o">=</span> <span class="n">extract_mfcc_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tsfel_feats</span><span class="p">,</span> <span class="n">mfcc_feats</span><span class="p">])</span>

        <span class="c1"># Sesuaikan panjangnya agar sama dengan feature_names</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">all_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_features</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">all_features</span> <span class="o">=</span> <span class="n">all_features</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">all_features</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Error saat ekstraksi fitur: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># 🧠 Prediksi</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predict_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prediksi kelas audio&quot;&quot;&quot;</span>
    <span class="n">y_proc</span><span class="p">,</span> <span class="n">sr_proc</span> <span class="o">=</span> <span class="n">preprocess_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;target_sr&quot;</span><span class="p">])</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">extract_combined_features</span><span class="p">(</span><span class="n">y_proc</span><span class="p">,</span> <span class="n">sr_proc</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">st</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Beberapa fitur mengandung NaN. Nilai diganti dengan 0.&quot;</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="n">features_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">features_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">features_df</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">y_proc</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># 🎧 Visualisasi audio</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_waveform_and_spectrogram</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">waveshow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Waveform&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Waktu (detik)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitudo&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">amplitude_to_db</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">librosa</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)),</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Spectrogram (dB)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%+2.0f</span><span class="s1"> dB&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="c1"># ==========================================================</span>
<span class="c1"># 🚀 Main App</span>
<span class="c1"># ==========================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;🎙️ Klasifikasi Suara Buka/Tutup&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Aplikasi ini mengklasifikasikan suara menjadi **Buka** atau **Tutup** </span>
<span class="s2">    menggunakan model Machine Learning berbasis **TSFEL + MFCC + Random Forest**.</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;🔄 Memuat model...&quot;</span><span class="p">):</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_model_artifacts</span><span class="p">()</span>

    <span class="c1"># Sidebar info</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;📊 Informasi Model&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Akurasi Training:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;train_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Akurasi Testing:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;test_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Jumlah Fitur:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;n_features&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Sample Rate:** </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target_sr&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Upload file .wav atau .mp3, lalu klik **Prediksi**.&quot;</span><span class="p">)</span>

    <span class="c1"># Upload file</span>
    <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">file_uploader</span><span class="p">(</span><span class="s2">&quot;📁 Upload file audio&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wav&quot;</span><span class="p">,</span> <span class="s2">&quot;mp3&quot;</span><span class="p">,</span> <span class="s2">&quot;m4a&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">uploaded_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.wav&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
            <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span>
            <span class="c1"># ✅ Konversi otomatis semua format ke .wav</span>
            <span class="n">raw_bytes</span> <span class="o">=</span> <span class="n">uploaded_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">audio</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw_bytes</span><span class="p">))</span>
            <span class="n">audio</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;wav&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">audio</span><span class="p">(</span><span class="n">raw_bytes</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;audio/wav&quot;</span><span class="p">)</span>

            <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Durasi&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">sr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> detik&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Sample Rate&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sr</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;🔍 Prediksi&quot;</span><span class="p">):</span>
                <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Memprediksi...&quot;</span><span class="p">):</span>
                    <span class="n">pred</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">y_proc</span> <span class="o">=</span> <span class="n">predict_audio</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pred</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;label_map&quot;</span><span class="p">][</span><span class="n">pred</span><span class="p">]</span>
                        <span class="n">confidence</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Prediksi:** </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

                        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;#### Probabilitas:&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;label_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
                            <span class="n">st</span><span class="o">.</span><span class="n">progress</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_waveform_and_spectrogram</span><span class="p">(</span><span class="n">y_proc</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;target_sr&quot;</span><span class="p">])</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing app.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-feature-importance">
<h2>8) Analisis Feature Importance<a class="headerlink" href="#analisis-feature-importance" title="Permalink to this heading">#</a></h2>
<p>Melihat fitur mana yang paling penting dalam membedakan suara “buka” dan “tutup” menggunakan Random Forest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================================</span>
<span class="c1"># 🔍 Analisis Feature Importance Random Forest</span>
<span class="c1"># ==========================================================</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Ambil feature importance dari model RandomForest yang sudah kamu latih</span>
<span class="n">rf_model</span> <span class="o">=</span> <span class="n">model</span>  <span class="c1"># ✅ langsung gunakan model kamu sebelumnya</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">feature_importances_</span>

<span class="c1"># Ambil nama fitur dari dataset bersih</span>
<span class="n">feature_names_clean</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Buat DataFrame untuk ranking</span>
<span class="n">importance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names_clean</span><span class="p">,</span>
    <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Tampilkan top 20 fitur</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔝 Top 20 Fitur Terpenting:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">importance_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 📊 Visualisasi Top 15 Feature Importance</span>
<span class="c1"># ==========================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">top_features</span> <span class="o">=</span> <span class="n">importance_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">top_features</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span> <span class="n">top_features</span><span class="p">[</span><span class="s1">&#39;importance&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="n">top_n</span><span class="si">}</span><span class="s1"> Fitur Terpenting untuk Klasifikasi Buka vs Tutup&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># 📈 Statistik Deskriptif untuk Top 5 Fitur</span>
<span class="c1"># ==========================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Statistik Deskriptif untuk Top 5 Fitur:&quot;</span><span class="p">)</span>
<span class="n">top_5_features</span> <span class="o">=</span> <span class="n">importance_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;feature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_with_labels</span> <span class="o">=</span> <span class="n">X_clean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">top_5_features</span><span class="p">:</span>
    <span class="n">buka_vals</span> <span class="o">=</span> <span class="n">X_with_labels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_with_labels</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">tutup_vals</span> <span class="o">=</span> <span class="n">X_with_labels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_with_labels</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Buka  - Mean: </span><span class="si">{</span><span class="n">buka_vals</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">buka_vals</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Min: </span><span class="si">{</span><span class="n">buka_vals</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">buka_vals</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Tutup - Mean: </span><span class="si">{</span><span class="n">tutup_vals</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">tutup_vals</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Min: </span><span class="si">{</span><span class="n">tutup_vals</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">tutup_vals</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🔝 Top 20 Fitur Terpenting:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>mfcc_mean_10</td>
      <td>0.105691</td>
    </tr>
    <tr>
      <th>34</th>
      <td>mfcc_std_3</td>
      <td>0.105144</td>
    </tr>
    <tr>
      <th>23</th>
      <td>mfcc_mean_5</td>
      <td>0.094488</td>
    </tr>
    <tr>
      <th>29</th>
      <td>mfcc_mean_11</td>
      <td>0.065327</td>
    </tr>
    <tr>
      <th>50</th>
      <td>mfcc_delta_mean_6</td>
      <td>0.061958</td>
    </tr>
    <tr>
      <th>22</th>
      <td>mfcc_mean_4</td>
      <td>0.058707</td>
    </tr>
    <tr>
      <th>24</th>
      <td>mfcc_mean_6</td>
      <td>0.056548</td>
    </tr>
    <tr>
      <th>21</th>
      <td>mfcc_mean_3</td>
      <td>0.039498</td>
    </tr>
    <tr>
      <th>30</th>
      <td>mfcc_mean_12</td>
      <td>0.033616</td>
    </tr>
    <tr>
      <th>35</th>
      <td>mfcc_std_4</td>
      <td>0.033386</td>
    </tr>
    <tr>
      <th>47</th>
      <td>mfcc_delta_mean_3</td>
      <td>0.028396</td>
    </tr>
    <tr>
      <th>54</th>
      <td>mfcc_delta_mean_10</td>
      <td>0.022958</td>
    </tr>
    <tr>
      <th>27</th>
      <td>mfcc_mean_9</td>
      <td>0.019804</td>
    </tr>
    <tr>
      <th>36</th>
      <td>mfcc_std_5</td>
      <td>0.017057</td>
    </tr>
    <tr>
      <th>32</th>
      <td>mfcc_std_1</td>
      <td>0.016902</td>
    </tr>
    <tr>
      <th>19</th>
      <td>mfcc_mean_1</td>
      <td>0.016510</td>
    </tr>
    <tr>
      <th>40</th>
      <td>mfcc_std_9</td>
      <td>0.015104</td>
    </tr>
    <tr>
      <th>26</th>
      <td>mfcc_mean_8</td>
      <td>0.011590</td>
    </tr>
    <tr>
      <th>31</th>
      <td>mfcc_mean_13</td>
      <td>0.010514</td>
    </tr>
    <tr>
      <th>33</th>
      <td>mfcc_std_2</td>
      <td>0.010411</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/fc07b42d714fe7c103d0adfe4db8b90aab900ab37f66a082c63711307b36edbf.png" src="_images/fc07b42d714fe7c103d0adfe4db8b90aab900ab37f66a082c63711307b36edbf.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>📊 Statistik Deskriptif untuk Top 5 Fitur:

mfcc_mean_10:
  Buka  - Mean: 1.3408, Std: 6.3681, Min: -15.0635, Max: 18.3898
  Tutup - Mean: -14.6773, Std: 10.6900, Min: -33.8784, Max: 17.0130

mfcc_std_3:
  Buka  - Mean: 22.2561, Std: 6.4364, Min: 9.9855, Max: 34.0467
  Tutup - Mean: 12.0384, Std: 3.7434, Min: 5.6401, Max: 25.5680

mfcc_mean_5:
  Buka  - Mean: -13.4233, Std: 6.7204, Min: -26.0342, Max: 3.5099
  Tutup - Mean: 1.6260, Std: 7.9410, Min: -17.3294, Max: 17.7843

mfcc_mean_11:
  Buka  - Mean: -4.5038, Std: 5.9910, Min: -20.7649, Max: 7.1173
  Tutup - Mean: -15.5543, Std: 7.5284, Min: -28.5318, Max: 1.0045

mfcc_delta_mean_6:
  Buka  - Mean: 0.5080, Std: 0.5536, Min: -0.3302, Max: 1.8807
  Tutup - Mean: -0.0632, Std: 0.2671, Min: -1.2976, Max: 0.8863
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Cloning_Suara.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Voice Cloning &amp; Augmentation untuk Training Dataset</p>
      </div>
    </a>
    <a class="right-next"
       href="Prediksi_NO2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Prediksi NO2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#persiapan-lingkungan-install-import">0) Persiapan lingkungan (install &amp; import)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muat-semua-file-audio-dari-folder-buka-dan-tutup">1) Muat semua file audio dari folder buka dan tutup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-durasi-audio-dan-statistik-dasar">2) Analisis durasi audio dan statistik dasar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konfigurasi-fitur-tsfel">3) Konfigurasi fitur TSFEL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur-tsfel-untuk-semua-audio">4) Ekstraksi fitur TSFEL untuk semua audio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bersihkan-fitur-nan-inf-simpan-ke-csv">5) Bersihkan fitur (NaN/Inf), simpan ke CSV</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standarisasi-visualisasi-pca-2d">6) Standarisasi &amp; visualisasi (PCA 2D)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-dengan-berbagai-algoritma">7) Klasifikasi dengan berbagai algoritma</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-feature-importance">8) Analisis Feature Importance</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Narendra Wardianto
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>